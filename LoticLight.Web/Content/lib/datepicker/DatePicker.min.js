function setday(n,t,i,r,u){if(null==n)return null;new Calendar(n,t,i,r,u).show()}function setmonth(n,t,i,r,u){if(null==n)return null;new Calendar(n,t,i,r,u,"m").show()}function getFrameDocument(n){var t;return n.contentDocument?t=n.contentDocument:n.contentWindow&&(t=n.contentWindow.document),t}function checkDate(n,t,i){var r=["31","28","31","30","31","30","31","31","30","31","30","31"];return n%4==0&&(r[1]="29"),i>r[t]?r[t]:i}function Calendar(n,t,i,r,u,f){this.beginDate="1900-01-01".toDate();this.endDate="2020-01-01".toDate();this.lang=0;this.type="d";this.dateFormatStyle="yyyy-MM-dd";null!=f&&(this.type=f,"m"==this.type&&(this.dateFormatStyle="yyyy-MM"));t!=null&&(this.dateFormatStyle=t);this.currentDate=new Date;var e=new Date;null!=n.value&&""!=n.value&&(e=n.value.toDate(this.dateFormatStyle));this.date=null!=e?e:new Date;null!=i&&(this.beginDate=i);null!=r&&(this.endDate=r);u!=null&&(this.lang=u);this.dateControl=n;this.panel=document.getElementById("calendarPanel");this.iframe=document.getElementById("calendarIframe");this.isFocus=!1;this.draw()}function getElementsByClassName(n,t,i){var f=t=="*"&&n.all?n.all:n.getElementsByTagName(t),e=[],o,u,r;for(i=i.replace(/\-/g,"\\-"),o=new RegExp("(^|\\s)"+i+"(\\s|$)"),r=0;r<f.length;r++)u=f[r],o.test(u.className)&&e.push(u);return e}Calendar.prototype.style=function(){var n="<style type='text/css'>";return n+=".calendar {font-size:12px; margin:0;padding:0px;border:1px solid #397EAE;background-color:#DBE7F2;}",n+=".calendar ul {list-style-type:none; margin:0; padding:0;vertical-align:middle;}",n+=".calendar li {float:left;}.calendar b{font-weight:bold;}",n+=".calendar .day li {height:20px;}",n+=".calendar .day li,.calendar .date li{float:left;width:14.13%;height:20px;line-height:20px;text-align:center;}",n+=".calendar .day li{font-weight:bold;} .calendar .date li{background-color:#EDF3F9;}",n+=".calendar .month li{float:left;width:24.8%;height:20px;line-height:20px;text-align:center;background-color:#EDF3F9;}",n+=".calendar li a{ text-decoration:none; font-family:Tahoma; font-size:11px; color:#333}",n+=".calendar li:hover {cursor:pointer;color:#f30; text-decoration:none;background-color:#EDF3F9;}",n+=".calendar .date li:hover, .calendar .month li:hover{cursor:pointer;color:#f30; text-decoration:none;background-color:#DBE7F2;}",n+=".calendarlihover {color:#f30;text-decoration:none;background-color:#E8F2FE;}",n+=".calendar li a.hasArticle {font-weight:bold; color:#f60 !important}",n+=".lastMonthDate, .nextMonthDate {color:#bbb;font-size:11px}",n+=".selectThisYear, .selectThisMonth{text-decoration:none; margin:0px; color:#000; font-weight:bold}",n+=".calendar .LastMonth, .calendar .NextMonth{text-decoration:none; color:#000; font-size:18px; font-weight:bold; line-height:16px;}",n+=".calendarTitle{background:#EDF3F9;text-align:center;height:20px;line-height:20px;clear:both;width:100%;}",n+=".calendarTitle .mark{text-decoration:none;color:#000;font-family:Tahoma;font-size:18px;font-weight:normal;}",n+=".today{ background-color:#ffffaa;border:1px solid #f60;padding:0 1px;}",n+=".today a { color:#f30; }",n+=".calendarBottom {text-align:center;height:20px;line-height:20px;clear:both;width:100%;border-top:1px solid #ddd;}",n+=".calendarBottom li{float:left;height:20px;line-height:20px;font-weight:bold;text-align:center;}",n+"<\/style>"};String.prototype.toDate=function(n){var u,r,i,h;if(null==n&&(n="yyyy-MM-dd"),u=n.replace("yyyy","(\\~1{4})").replace("yy","(\\~1{2})").replace("MM","(\\~1{2})").replace("M","(\\~1{1,2})").replace("dd","(\\~1{2})").replace("d","(\\~1{1,2})").replace(/~1/g,"d"),new RegExp(u).test(this)){var f=n.indexOf("yyyy"),e=n.indexOf("MM"),o=n.indexOf("dd");e==-1&&(e=n.indexOf("M"));f==-1&&(f=n.indexOf("yy"));o==-1&&(o=n.indexOf("d"));var c=[f+"y",e+"m",o+"d"],t={y:0,m:0,d:1},s=this.match(u);for(i=1;i<s.length;i++){if(i==0)return;h=c[i-1].split("")[1];t[h]=s[i]}t.y.toString().length==2&&(t.y=parseInt("20"+t.y));t.m=t.m-1;r=new Date(t.y,t.m,t.d)}return(r==null||isNaN(r))&&(r=new Date),r};Date.prototype.format=function(n){var i={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"w+":"日一二三四五六".charAt(this.getDay()),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()},t;/(y+)/.test(n)&&(n=n.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(t in i)new RegExp("("+t+")").test(n)&&(n=n.replace(RegExp.$1,RegExp.$1.length==1?i[t]:("00"+i[t]).substr((""+i[t]).length)));return n};Date.prototype.dateAdd=function(n,t){switch(n){case"y":return new Date(this.getFullYear()+t,this.getMonth(),this.getDate());case"m":return new Date(this.getFullYear(),this.getMonth()+t,checkDate(this.getFullYear(),this.getMonth()+t,this.getDate()));case"d":return new Date(this.getFullYear(),this.getMonth(),this.getDate()+t);case"w":return new Date(this.getFullYear(),this.getMonth(),7*t+this.getDate())}};Calendar.language={title:[["",""],["年","月"]],months:[["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]],weeks:[["S","M","T","W","T","F","S"],["日","一","二","三","四","五","六"]],weekday:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],clear:[["Clear"],["清空"]],today:[["Today","Current"],["今天","当月"]],close:[["Close"],["关闭"]]};Calendar.prototype.draw=function(){var s=this.date.format("yyyy-MM").toDate("yyyy-MM"),e,o,t,i,r;s<this.beginDate&&(this.date=this.beginDate);s>this.endDate&&(this.date=this.endDate);this.year=this.date.getFullYear();this.month=this.date.getMonth();var c='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />'+this.style()+'<\/head><body style="padding:0px;margin:0px;">',u=this.date.dateAdd("d",1-this.date.getDate()),f=u.dateAdd("d",-1),l=u.getDay();f=f.getDate();var h=u.dateAdd("m",1).dateAdd("d",-1),a=h.getDate(),v=h.getDay(),n="<div id='calendar' class='calendar' style='width:";if(n+="d"==this.type?"150":"120",n+="px;'>",n+="<div class='calendarTitle'><ul>",n+="<li id='PrevYear' class='mark' style='width:12%;' title='Previous Year'>&laquo;<\/li>","d"==this.type){for(n+="<li id='PrevMonth' class='mark' style='width:12%;' title='Previous Month'>&lsaquo;<\/li>",n+="<li style='width:30%;'><span id='selectThisYear' class='selectThisYear'>"+this.date.getFullYear()+"<\/span>"+Calendar.language.title[this.lang][0]+"<\/li>",n+=0==this.lang?"<li style='width:20%;'><span id='selectThisMonth' class='selectThisMonth'>"+Calendar.language.months[this.lang][this.date.getMonth()]+"<\/span><\/li>":"<li style='width:20%;'><span id='selectThisMonth' class='selectThisMonth'>"+(this.date.getMonth()+1)+"<\/span>"+Calendar.language.title[this.lang][1]+"<\/li>",n+="<li id='NextMonth' class='mark' style='width:12%;' title='Next Month'>&rsaquo;<\/li>",n+="<li id='NextYear' class='mark' style='width:12%;' title='Next Year'>&raquo;<\/li><\/ul><\/div>",n+="<div class='calendarBody'>",n+="<ul class='day'>",t=0;t<Calendar.language.weeks[this.lang].length;t++)n+="<li title='"+Calendar.language.weekday[t]+"'>"+Calendar.language.weeks[this.lang][t]+"<\/li>";for(n+="<\/ul><ul class='date' id='thisMonthDate'>",e="",t=0;t<l;t++)e="<li class='lastMonthDate'>"+f+"<\/li>"+e,f--;for(n+=e,t=1;t<=a;t++){if(i=u.dateAdd("d",t-1),i<this.beginDate||i>this.endDate){n+="<li class='lastMonthDate'>"+t+"<\/li>";continue}n+="<li class='thisMonth' title='"+i.format("yyyy-MM-dd")+"'><a href='javascript:void(0);' ";i.format("yyyy-MM-dd")==this.date.format("yyyy-MM-dd")&&(n+="class='today' ");n+=">"+t+"<\/a><\/li>"}for(o=1,t=v;t<6;t++)n+="<li class='nextMonthDate'>"+o+"<\/li>",o++;n+="<\/ul>";n+="<\/div>";n+="<div class='calendarBottom'><ul>";n+="<li id='emptyCalendar' style='width:27%;' title='Clear'>"+Calendar.language.clear[this.lang]+"<\/li>";n+="<li id='selectCurrent' style='width:45%;' title='Today'>"+Calendar.language.today[this.lang][0]+"<\/li>"}else{for(n+="<li style='width:74%;'><span id='selectThisYear' class='selectThisYear'>"+this.date.getFullYear()+"<\/span>"+Calendar.language.title[this.lang][0]+"<\/li>",n+="<li id='NextYear' class='mark' style='width:12%;' title='Next Year'>&raquo;<\/li><\/ul><\/div>",n+="<div class='calendarBody'>",n+="<\/ul><ul class='month' id='thisMonth'>",t=1;t<=12;t++){if(i=(this.year+"-"+(t>9?t:"0"+t)).toDate("yyyy-MM"),i<this.beginDate||i>this.endDate){n+="<li class='lastMonthDate'>"+t+"<\/li>";continue}n+="<li class='thisMonth' title='"+this.year+"-"+(t>9?t:"0"+t)+"-01'><a href='javascript:void(0);'";this.year+"-"+(t>9?t:"0"+t)==this.date.format("yyyy-MM")&&(n+=" class='today' ");n+=">"+t+"<\/a><\/li>"}n+="<\/ul>";n+="<\/div>";n+="<div class='calendarBottom'><ul>";n+="<li id='emptyCalendar' style='width:27%;' title='Clear'>"+Calendar.language.clear[this.lang]+"<\/li>";n+="<li id='selectCurrent' style='width:45%;' title='Current Month'>"+Calendar.language.today[this.lang][1]+"<\/li>"}n+="<li id='closeCalendar' style='width:27%;' title='Close'>"+Calendar.language.close[this.lang]+"<\/li>";n+="<\/ul><\/div>";n+="<\/div>";n+="<\/body><\/html>";r=getFrameDocument(this.iframe);r.writeln(c);r.writeln(n);r.close();this.document=r;this.bingEvent()};Calendar.prototype.bingEvent=function(){var n=this,i,t;for(this.setAutoHeight(),this.panel.onmouseover=function(){n.isFocus=!0},this.panel.onmouseout=function(){n.isFocus=!1},this.dateControl.onblur=function(){n.isFocus||n.hide()},this.getElementById("selectCurrent").onclick=function(){n.date=new Date;n.valueSelected(n.date);n.hide()},this.getElementById("emptyCalendar").onclick=function(){n.dateControl.value="";n.hide()},this.getElementById("closeCalendar").onclick=function(){n.hide()},this.getElementById("PrevYear").onclick=function(){n.date=n.date.dateAdd("y",-1);n.draw()},this.getElementById("PrevMonth")&&(this.getElementById("PrevMonth").onclick=function(){n.date=n.date.dateAdd("m",-1);n.draw()},this.getElementById("NextMonth").onclick=function(){n.date=n.date.dateAdd("m",1);n.draw()}),this.getElementById("NextYear").onclick=function(){n.date=n.date.dateAdd("y",1);n.draw()},this.getElementById("selectThisYear").onclick=function(){n.selectThisYear()},"d"==this.type&&(this.getElementById("selectThisMonth").onclick=function(){n.selectThisMonth()}),i=getElementsByClassName(this.document,"li","thisMonth"),t=0;t<i.length;t++)i[t].onclick=function(){n.date=this.title.toDate();n.valueSelected(n.date);n.hide()}};Calendar.prototype.selectThisYear=function(){for(var t,r=this,f=this.date.getFullYear(),e=this.beginDate.getFullYear(),o=this.endDate.getFullYear(),u=this.getElementById("selectThisYear"),i="<select style='font-size:10px;'>",n=o;n>=e;n--)i+="<option value='"+n+"'>"+n+"<\/option>";i+="<\/select>";u.innerHTML=i;t=u.childNodes(0);t.value=f;t.onchange=function(){r.date.setFullYear(t.value);r.draw()}};Calendar.prototype.selectThisMonth=function(){var u=this,e=this.date.getMonth()+1,o=this.date.getFullYear(),s=this.endDate.getFullYear(),f=12,r,t,n,i;for(o==s&&(f=this.endDate.getMonth+1),r=this.getElementById("selectThisMonth"),t="<select style='font-size:10px;'>",n=1;n<=f;n++)t+="<option value='"+n+"'>"+Calendar.language.months[this.lang][n-1]+"<\/option>";t+="<\/select>";r.innerHTML=t;i=r.childNodes(0);i.value=e;i.onchange=function(){u.date.setMonth(i.value-1);u.draw()}};Calendar.prototype.valueSelected=function(n){this.dateControl.value=n.format(this.dateFormatStyle)};Calendar.prototype.setAutoHeight=function(){var t=this.document.body.scrollHeight,n=this.getElementById("calendar").style.width;n=parseInt(n.substr(0,n.length-1))+2+"px";this.iframe.style.height=t;this.panel.style.height=t;this.panel.style.width=n};Calendar.prototype.getElementById=function(n){if(typeof n!="string"||n==""||null==this.document)return null;if(this.document.getElementById)return this.document.getElementById(n);if(this.document.all)return this.document.all(n);try{return eval(n)}catch(t){return null}};Calendar.prototype.getElementsByTagName=function(n){return null==this.document?null:this.document.getElementsByTagName?this.document.getElementsByTagName(n):this.document.all?this.document.all.tags(n):void 0};Calendar.prototype.getAbsPoint=function(n){for(var t=n.offsetLeft,i=n.offsetTop;n=n.offsetParent;)t+=n.offsetLeft,i+=n.offsetTop;return{x:t,y:i}};Calendar.prototype.show=function(){var n=this.getAbsPoint(this.dateControl);this.panel.style.left=n.x+"px";this.panel.style.top=n.y+this.dateControl.offsetHeight+"px";this.setDisplayStyle("select","hidden");this.panel.style.visibility="visible"};Calendar.prototype.hide=function(){this.setDisplayStyle("select","visible");this.panel.style.visibility="hidden";this.isFocus=!1};Calendar.prototype.setDisplayStyle=function(n,t){for(var r=this.getElementsByTagName(n),i=0;i<r.length;i++)(n.toLowerCase()!="select"||r[i].name!="calendarYear"&&r[i].name!="calendarMonth")&&(r[i].style.visibility=t)};document.write('<div id="calendarPanel" style="position:absolute;visibility:hidden;z-index:9999;background-color:#FFFFFF;font-size:12px;width:20px;">');document.write("<iframe id='calendarIframe' scrolling='no' frameborder='0' width='100%' height='100%'><\/iframe><\/div>");